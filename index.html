<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mafia Bingo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      text-align: center;
      padding: 20px;
    }
    #login {
      margin-bottom: 20px;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(4, 100px);
      grid-template-rows: repeat(4, 100px);
      gap: 5px;
      justify-content: center;
      margin-top: 20px;
    }
    .square {
      background: white;
      border: 2px solid #333;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      padding: 5px;
      cursor: pointer;
      user-select: none;
    }
    .square.checked {
      background: #90ee90;
      text-decoration: line-through;
    }
  </style>
</head>
<body>
  <div id="login">
    <input type="text" id="username" placeholder="Enter your username">
    <button id="startBtn">Start</button>
  </div>

  <div id="board"></div>

  <script>
    const roles = [
      "detective","distractor","doctor","duskweaver","gambler","guardian","judge",
      "lawyer","link","manager","mayor","mortician","oracle","PI","spy","watcher",
      "vigilante","blackmailer","hacker","harbinger","framer","godfather","goose",
      "manipulator","mimic","necromancer","politician","ritualist","silencer","baker",
      "baiter","bomber","cupid","doomsayer","executioner","hoarder","isekai","magician",
      "jester","plague doctor","santa","shaman","starspawn","submissioner","thief","alchemist"
    ];

    const boardDiv = document.getElementById("board");
    const startBtn = document.getElementById("startBtn");
    const usernameInput = document.getElementById("username");
    let currentUsername = "";

    function seededRandom(seed) {
      let x = Math.sin(seed++) * 10000;
      return x - Math.floor(x);
    }

    function getSeededShuffle(seed, arr) {
      let array = arr.slice();
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(seededRandom(seed + i) * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function saveProgress(username) {
      const checked = [];
      boardDiv.querySelectorAll(".square").forEach(sq => {
        if (sq.classList.contains("checked")) {
          checked.push(sq.textContent);
        }
      });
      localStorage.setItem("bingo-" + username, JSON.stringify(checked));
    }

    function loadProgress(username) {
      const saved = localStorage.getItem("bingo-" + username);
      return saved ? JSON.parse(saved) : [];
    }

    function generateBoard(username) {
      boardDiv.innerHTML = "";
      let seed = 0;
      for (let i = 0; i < username.length; i++) {
        seed += username.charCodeAt(i);
      }

      const shuffled = getSeededShuffle(seed, roles);
      const selected = shuffled.slice(0, 16);

      const savedChecked = loadProgress(username);

      selected.forEach(role => {
        const sq = document.createElement("div");
        sq.className = "square";
        sq.textContent = role;
        if (savedChecked.includes(role)) {
          sq.classList.add("checked");
        }
        sq.addEventListener("click", () => {
          sq.classList.toggle("checked");
          saveProgress(username);
        });
        boardDiv.appendChild(sq);
      });
    }

    startBtn.addEventListener("click", () => {
      const username = usernameInput.value.trim();
      if (!username) return;
      currentUsername = username;
      generateBoard(username);
    });
  </script>
</body>
</html>
